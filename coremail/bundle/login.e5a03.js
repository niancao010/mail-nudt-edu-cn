(self.webpackJsonp=self.webpackJsonp||[]).push([[535],{79090:function(e,t,a){'use strict';a.r(t);var n=a(10150),o=a(3279),i=a(73522),r=i.DATA,l=i.lpImg,c=i.facadeCustom,s=a(59652)('',SYS_CONST.templates).helpers({customLpImg:function(e,t){return l(e)||t}}),d=l(c.background);if(n('.main .content').html(s.contentTpl(r)),n('.main .aside').html(s.asideTpl(r)),c){var u=function(e,t,a){return n(e).css(_.assign({},t,a))};u('.slogan',{color:c.slogan_color,fontSize:c.slogan_fontsize}),u('.main-bottom',{backgroundColor:c.background_color},d&&{backgroundImage:'url('+d+')',filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+d+'", sizingMethod="scale")'}),u('.u-form .u-btn',{backgroundColor:c.submit_button_color,color:c.submit_button_font_color})}if(!d){var f=0|2*Math.random();n('.main-bottom').addClass('main-bottom-'+f),n('.main-middle').addClass('main-middle-'+f)}function g(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var m=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],h=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];var v=a(7736),p=a(42601),b=a(78672),w=b.$,C=b.show,E=b.hide,y=b.hidden,T=b.echo,k=b.setSid,S=function(e){return'mobile'===e.val()};function x(e){if(S(e))return t=D.val().trim(),a=L.val(),p.test(t)?a?X.wmCall('user:login',{smsaddr:t,verifyCellCode:a,face:w('#face').val(),locale:w('#locale').val(),returnMainURL:!0}).then((function(e){location.href=e.mainURL})).catchCode(['FA_NEED_VERIFY_CELL','FA_INVALID_TEMP_SESSION'],(function(){T(I('login/cell_code_expired'),L)})).catchCode('FA_INVALID_VERIFY_CELL',(function(){T(I('login/FA_NEED_VERIFY_CELL'),L)})):T(I('login/FA_NEED_VERIFY_CELL'),L):T(I('login/login_err_cell_number'),D),!0;var t,a;y(U)&&U.remove(),D.remove(),L.remove()}var A=w('.mobile-angle');function F(e){var t=n('.j-send-code');a(42834)(t,t,['sms',e],I('login/resend'))}n('body').on('click','[data-operation]:not(.disabled)',(function(){({sendCode:j,closeTip:function(){return E(A)}}[n(this).data('operation')]||n.noop)()}));var D=w('.j-cell-number'),L=w('.j-verify-cell-code'),U=w('.j-verify-code-wrapper'),N=w('input[name=verifyCode]'),R=!y(U);function j(){var e=D.val().trim(),t=N.val();p.test(e)?y(U)?V(I('login/alert_captcha')):t?(T(),X.wmCall('user:login',{smsaddr:e,verifyCode:t,supportSms:2})['catch']((function(e){var t=e||0,a=t.code,n=t.smsFailCode,o=/_VERIFY_CODE$/.test(a)?'alert_captcha':{FA_USER_NOT_FOUND:'cell_not_found',FA_EXHAUSTED:'FA_TOO_FREQUENTLY'}[a]||n;'FA_INVALID_TEMP_SESSION'===a?V(I('login/'+a)):o?(T(I('login/'+o)),O()):'FA_NEED_VERIFY_CELL'===a?(E(U),F(),C(A),setTimeout(E.bind(null,A),5e3)):X.rethrow()}))):T(I('login/alert_captcha'),N):T(I('login/login_err_cell_number'),D)}function V(e){v().then((function(e){k(e),O()})),e&&T(e,N)}function O(){C(U).find('img').attr('src',X.wmURL('displayVerifyCode.jsp?category=login&rnd='+ +new Date)),N.val('')}var P=a(6257),M=a(6267),Y=a(44399),$=a(94956),q=a(9394),z=a(72780),B=a(78672),K=a(3412),Q=a(94821),J=Y.alert,Z=self.SYS_CONST,H=Z.secondAuthMeta,W=H.needToAuth,G=!('none'===H.config||'custom'===H.config),ee=X.S.authDeviceKeep,te=z.LE8,ae=z.LE7,ne='uid',oe='saveUsername',ie='domain',re='face',le='locale',ce={expires:30,path:'/'};setTimeout((function(){!function(e,t){var a=n(e),o=document.createElement('canvas');function i(e,t,a,n,o,i){var r;try{r=e.getImageData(t,a,n,o)}catch(l){netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserRead'),r=e.getImageData(t,a,n,o)}!function(e,t,a,n){var o,i,r,l,c,s,d,u,f,v,p,_,b,I,w,C,E,y,T,k,S,x=t.data,A=a+a+1,F=e-1,D=n-1,L=a+1,U=L*(L+1)/2,N=new g,X=N;for(r=1;r<A;r++)X=X.next=new g,r===L&&(S=X);X.next=N;var R=null,j=null;d=s=0;var V=m[a],O=h[a];for(i=0;i<n;i++){for(I=w=C=u=f=v=0,p=L*(E=x[s]),_=L*(y=x[s+1]),b=L*(T=x[s+2]),u+=U*E,f+=U*y,v+=U*T,X=N,r=0;r<L;r++)X.r=E,X.g=y,X.b=T,X=X.next;for(r=1;r<L;r++)l=s+((F<r?F:r)<<2),u+=(X.r=E=x[l])*(k=L-r),f+=(X.g=y=x[l+1])*k,v+=(X.b=T=x[l+2])*k,I+=E,w+=y,C+=T,X=X.next;for(R=N,j=S,o=0;o<e;o++)x[s]=u*V>>O,x[s+1]=f*V>>O,x[s+2]=v*V>>O,u-=p,f-=_,v-=b,p-=R.r,_-=R.g,b-=R.b,l=d+((l=o+a+1)<F?l:F)<<2,u+=I+=R.r=x[l],f+=w+=R.g=x[l+1],v+=C+=R.b=x[l+2],R=R.next,p+=E=j.r,_+=y=j.g,b+=T=j.b,I-=E,w-=y,C-=T,j=j.next,s+=4;d+=e}for(o=0;o<e;o++){for(w=C=I=f=v=u=0,p=L*(E=x[s=o<<2]),_=L*(y=x[s+1]),b=L*(T=x[s+2]),u+=U*E,f+=U*y,v+=U*T,X=N,r=0;r<L;r++)X.r=E,X.g=y,X.b=T,X=X.next;for(c=e,r=1;r<=a;r++)s=c+o<<2,u+=(X.r=E=x[s])*(k=L-r),f+=(X.g=y=x[s+1])*k,v+=(X.b=T=x[s+2])*k,I+=E,w+=y,C+=T,X=X.next,r<D&&(c+=e);for(s=o,R=N,j=S,i=0;i<n;i++)x[l=s<<2]=u*V>>O,x[l+1]=f*V>>O,x[l+2]=v*V>>O,u-=p,f-=_,v-=b,p-=R.r,_-=R.g,b-=R.b,l=o+((l=i+L)<D?l:D)*e<<2,u+=I+=R.r=x[l],f+=w+=R.g=x[l+1],v+=C+=R.b=x[l+2],R=R.next,p+=E=j.r,_+=y=j.g,b+=T=j.b,I-=E,w-=y,C-=T,j=j.next,s+=e}}(n,r,i,o),e.putImageData(r,t,a)}o.getContext&&(t=n.extend({source:'body',offset:{x:0,y:0}},t),a.each((function(){var e=n(this),a=n(t.source),r=a.css('backgroundImage').replace(/"/g,'').replace(/url\(|\)$/gi,''),l=o.getContext('2d'),c=new Image;c.onload=function(){function n(n){var o=a.css('backgroundAttachment'),i='fixed'===o?'':'-'+(e.offset().left-a.offset().left-t.offset.x)+'px -'+(e.offset().top-a.offset().top-t.offset.y)+'px';e.css({'background-image':'url("'+n+'")','background-repeat':a.css('backgroundRepeat'),'background-position':i,'background-attachment':o})}o.style.display='none',o.width=c.width,o.height=c.height,l.drawImage(c,0,0),i(l,0,0,o.width,o.height,t.radius||5),n(o.toDataURL())},c.src=r})))}('.aside-blur',{source:'.main-bottom',radius:5})}),500);var se,de,ue,fe='logintype',ge='normalForm',me='QRCode',he=B.$,ve=he(),pe=he('input[name=loginType]'),_e=he('#face');function be(){if((W||G)&&ae)return Ce(I('login/login_warn_low_version_second_auth'))}setTimeout(n.fn.click.bind((se='a',de=fe,ue=pe.val()||location.hash.slice(1),n(se+'['+de+']').filter((function(){return ue===n(this).attr(de)}))))),pe.val(''),be(),ae||'FA_NEED_BIND_DEVICE'!==Z.loginResultCode||K.m((function(){he('#uid').hide(),Ee(ye)}));var Ie,we=o(n('body')).trigger('render').addClass(Z.imgCDN&&'cdn');function Ce(e){return J(e,{confirmTpl:I('login/login_warn_confirm')})}function Ee(e){if(!be()){var t=B.action(e),a=!1,n=_e.val();n&&('X'===n&&te&&(Ce(I('login/login_warn_low_version')).then(t),a=!0,n='XT3'),_e.val(n='auto'===n?te?'XT3':'X':n),M.set(re,n,ce));var o=he('#locale');o[0]&&M.set(le,o.val(),ce),B.formatUid();var i=he('#saveUsername').not(':hidden');if(i.is(':checked')||ee){M.set(oe,!0,ce),M.set(ne,B.getFullUid(),ce);var r=he('#domain');r.length>0&&M.set(ie,r.val(),ce)}else i[0]&&(M.remove(oe,{path:'/'}),M.remove(ne,{path:'/'}));!a&&t()}}function ye(){var e;he('#uid').is(':hidden')?he('#uid, #password, #domain').prop('disabled',!0):(B.formatUid(),e=B.getFullUid()),ee&&K.K(e),x(pe)||ve.submit()}function Te(){null==Ie||Ie(),X.wmCall('!qrSession').then((function(e){X.s=e,Se(''),(0,P.Z)(n('.QRCodeImage'),''+$(X.r+'/qr/'+e),Te,_.fun(Se)),function(e){if(window.WebSocket){var t=a(47400);t.subscribe('onstat/mail/'+e+'/op_app_qrcode_login',o),Ie=t.destroy}else Ie=a(14877)(X.wmBind({url:'getProcessStatus.jsp',sid:e}),o);function o(e){var t=(e||{}).payload,a=(t||{}).status,n=ke.hasClass('appVerify');switch(Se(a),a){case'appVerify':i(t.avatar,t.gender),r(t.trueName,t.email);break;case'final':n?setTimeout(_.fn(open,t.url,'_self'),500):Se(''),Ie()}}function i(e,t){n('.headImage img').attr('src',e||X.r+'/avatar/:'+t)}function r(e,t){n('.headImageArea .loggedUsername').html(e||t)}}(e)}))}!function(){var e=n('.loginArea'),t=ge;function a(e,t){var a=t.data(),o=a.locale,i=a.face,r=a.domain;e.find('li .iconfont').remove(),t.addClass('u-menu-choose').append('<i class="iconfont iconchoose left"></i>'),o?(n('#locale').val(o),M.set(le,o,ce),he('[name="action:login"]').remove(),ve.submit()):i?(n('.faceTxt').html(t.text()),_e.val(i)):r&&(n('.domainTxt').html(r),n('#domain').val(r))}we.click((function(o){var i=n(o.target),r=i.closest('a').attr(fe);if(r){var l=t;n('.j-qr-code-return').attr(fe,t),r!==t&&(location.hash=r===ge?'':'#'+r,pe.val(r===ge?'':r),e.toggleClass(l+' '+r),t=r,r===me?Te():l!==me&&function(e,t){T(),S(e)?(V(),F(!1)):(t&&k(t),R?O():E(U))}(pe,X.s))}var c=i.closest('.loginLang,.faceMenu,.domainMenu'),s=n('.u-menu');s.hide(),c[0]&&(i.is('a')?a(c,i.parent()):c.find(s).show())})),function(){var e,t=M.get(ie)||'',a=M.get(ne)||'';t.length>0&&(he('[data-domain="'+t+'"] a').click(),a=a.split('@')[0]);a.length>0&&he('#uid').val(a);var n=M.get(oe)||'';he('#saveUsername').length&&he('#saveUsername').prop('checked','true'===n);var o=null==(e=M.get(re))?void 0:e.replace(/^XT[56]$/,'X');o&&he('[data-face="'+o+'"] a').click(),q.loadPassword(he('#fakePassword'))}(),n('.favourite').click((function(){try{window.external.AddFavorite(location.href,document.title)}catch(e){try{window.sidebar.addPanel(location.href,document.title,'')}catch(t){J(n(this).data('msg'))}}})),n('.j-recoverPwd').click((function(){var e=n(this).attr('href'),t=he('#uid').val();if(t){var a=e.indexOf('?');if(-1!==a){var o,i,r=e.substr(0,a),l=e.substr(a+1).split('&'),c='';for(o=0;o<l.length;o++)if(-1!==(i=l[o]).indexOf('uid')){var s=i.split('=');s[1]=t,c+=s[0]+'='+s[1]+'&'}else c+=i+'&';c=c.substr(0,c.length-1),n(this).attr('href',r+'?'+c)}else e+='?uid='+t,n(this).attr('href',e)}})),n('.j-ssl-login-button').click((function(){var e=ve.attr('action');location.href='https://'+location.hostname+(80!==location.port?':'+location.port:'')+e.replace(/index.jsp.*/,'index_ca.jsp')})),B.init(Ee.bind(null,ye))}(),W&&Q();var ke=n('.qr-code-login');function Se(e){ke.attr('class','qr-code-login '+(null!=e?e:'loginFail'))}},71885:function(e,t,a){'use strict';a.r(t);var n=a(10150),o=a(3279),i=a(6267),r=a(9394),l=a(73522),c=a(61277),s=a(59652)('',SYS_CONST.templates),d=l.facadeCustom;function u(e,t){var a=I.login[e];return'DEFAULT'===a?t:a||t}!function(){n('img',n('a',n('.logo')).attr('href',d.logo_link||'https://www.coremail.cn')).attr('src',l.lpImg(d.logo)||u('login_logo_path','common/assets/index_cmxt50/img/logo.png'));var e=d.copyright_text||u('login_copyright',I('main/copyright')),t=d.copyright_link;n('.copyright').html(t?n('<a>',{target:'_blank',href:t,html:e}):e)}(),(0,c.Z)(n('.main').html(s.loginFormTpl(l.DATA)));var f=a(78672),g=a(3412),m=a(94821),h='uid',v='saveUsername',p='domain',_='face',b='locale',w={expires:30,path:'/'},C=f.$,E=C(),y=C('[name=needTransLogin]');function T(){n('.container').show(),n('.j-layout-loading').hide()}f.init(D),r.loadPassword(C('#fakePassword')),'FA_NEED_BIND_DEVICE'===SYS_CONST.loginResultCode?C('[name=toAdmin]').val()&&!C('.j-try-collect').val()?D():(g.m(D),T()):y.val()?(D(),y.val('')):T(),o(n('body'));var k=SYS_CONST.secondAuthMeta,S=k.needToAuth,x=k.trans,A=k.transEx,F=k.device;function D(){var e,t=f.action(L),a=C('#face'),n=a.val();a.val('auto'===n?null==(e=i.get(_))?void 0:e.replace(/^XT[56]$/,'X'):n);var o=C('#locale');if(o.length>0&&i.set(b,o.val(),w),f.formatUid(),C('#saveUsername').prop('checked')){i.set(v,!0,w),i.set(h,f.getFullUid(),w);var r=C('#domain');r.length>0&&i.set(p,r.val(),w)}else i.remove(v,{path:'/'}),i.remove(h,{path:'/'});t()}function L(){f.formatUid();var e=f.getFullUid();X.S.authDeviceKeep&&g.K(e),E.submit()}S&&m(x,A,F)},94821:function(e,t,a){var n=a(10150),o=a(78672),i=o.$,r=i('[name=onlyValidate2FA]').val(),l=i('[name=toAdmin]').val(),c=i('[name=tryCollect]').val(),s=i('.j-submit'),d=n('.j-second-auth-wrap'),u=a(61938),f=a(18568).queryValidateStage;function g(e){n('.loginType, .qr-code-switch').toggle(!e),i().toggle(!e).toggleClass('inTwoFactorVerify',e),d.toggle(e)}e.exports=function(e,t,m){function h(){var e=i('[name=startReferer]').val();e?location.replace(e):g(!1)}f({tempSid:X.s,trans:u.getTrans(e)}).fin((function(f){f?(g(!0),u.call(n('.j-auth-body',d)[0],[e|=0,t,m],(function(t,n,d){t?r&&!c&&l?location.href=a(94956).addUrlParams(l.replace(/\$sid/,t),0===e&&{authorizeDevice:n}):(n&&i('.j-authorizeDevice').val(!0),s.click()):r&&l?location.href=l.replace(/\$sid/,n||t):(o.echo(d||I('login/FA_INVALID_TEMP_SESSION')),h())}),X.s),n('.j-auth-back',d).off('click').click((function(){o.echo(''),h()})).toggle(!r)):(o.echo(''),h())}))}}}]);
//# sourceMappingURL=login.e5a03.js.map